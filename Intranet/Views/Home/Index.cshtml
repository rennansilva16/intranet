@model List<Participante>

<p>Modelo recebido: @(Model == null ? "Nulo" : Model.Count + " contatos")</p>

<div class="text-center">
    <h1 class="display-4">Welcome</h1>
    <p>Learn about <a href="https://learn.microsoft.com/aspnet/core">building Web apps with ASP.NET Core</a>.</p>
</div>

<!-- Calendário -->
<div id="calendar"></div>

<!-- Modal para adicionar/editar/visualizar evento -->
<section>
    <div id="modalEvento" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2 id="modalTitulo">Detalhes do Evento</h2>

            <label for="titulo">Título:</label>
            <input type="text" id="titulo" disabled>

            <label for="descricao">Descrição:</label>
            <textarea id="descricao" disabled></textarea>

            <label for="dataInicio">Data Início:</label>
            <input type="datetime-local" id="dataInicio" disabled>

            <label for="dataFim">Data Fim:</label>
            <input type="datetime-local" id="dataFim" disabled>

            <label for="participante">Participante:</label>
            <select id="participante" disabled>
                <option value="">Selecione um participante</option>
            </select>

            <button id="editarEvento" style="background-color: blue; color: white;">Editar</button>
            <button id="salvarEvento" style="display: none;">Salvar</button>
            <button id="btnExcluir" style="background-color: red; color: white; display: none;">Excluir</button>
        </div>
    </div>
</section>

<section>
    <button onclick="abrirModalAdicionar()">Adicionar Contato</button>
    <table border="1">
        <thead>
            <tr>
                <th>Divisão</th>
                <th>Nome</th>
                <th>Email</th>
                <th>Telefone</th>
                <th>Celular</th>
                <th>Aniversário</th>
                <th>Ações</th>
            </tr>
        </thead>
        <tbody>
            @if (Model != null && Model.Any())
            {
                @foreach (var contato in Model)
                {
                    <tr>
                        <td>@contato.Divisao</td>
                        <td>@contato.Nome</td>
                        <td>@contato.Email</td>
                        <td>@contato.Telefone</td>
                        <td>@contato.Celular</td>
                        <td>@contato.DataNascimento.ToString("dd/MM/yyyy")</td>
                        <td>
                            <button onclick="abrirModalEditar(@contato.Id)">✏</button>
                            <button onclick="confirmarExclusao(@contato.Id)">❌</button>
                        </td>
                    </tr>
                }
            }
            else
            {
                <tr>
                    <td colspan="7">Nenhum contato encontrado.</td>
                </tr>
            }
        </tbody>

    </table>
</section>

<!-- Modal -->
<div id="modal" class="modal">
    <div class="modal-content">
        <span class="fechar" onclick="fecharModal()">&times;</span>
        <div id="conteudoModal"></div>
    </div>
</div>

<script>
    function abrirModalAdicionar() {
        fetch('/Contato/Adicionar')
            .then(response => response.text())
            .then(html => {
                document.getElementById("conteudoModal").innerHTML = html;
                document.getElementById("modal").style.display = "block";
            });
    }

    function abrirModalEditar(id) {
        fetch('/Contato/Editar?id=' + id)
            .then(response => response.text())
            .then(html => {
                document.getElementById("conteudoModal").innerHTML = html;
                document.getElementById("modal").style.display = "block";
            });
    }

    function fecharModal() {
        document.getElementById("modal").style.display = "none";
    }

    function confirmarExclusao(id) {
        if (confirm("Tem certeza que deseja excluir?")) {
            window.location.href = "/Contato/Excluir?id=" + id;
        }
    }
</script>

<style>
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); }
    .modal-content { background: white; padding: 20px; margin: 10% auto; width: 50%; }
    .fechar { float: right; cursor: pointer; font-size: 24px; }
</style>
